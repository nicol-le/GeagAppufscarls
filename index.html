<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algodão-Geag</title>
    <link rel="shortcut icon" type="imagex/png" href="Design sem nome (16).png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            padding-top: 60px;
        }

        header {
            width: 100%;
            height: 60px;
            background-color: #003399;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 10;
        }

        .main-content {
            margin-top: 20px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .app-container {
            max-width: 400px;
            padding: 20px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .form-group {
            margin-bottom: 10px;
        }

        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }

        input, textarea, select, button {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        button {
            background: #003399;
            color: #fff;
            border: none;
            cursor: pointer;
            margin-top: 10px;
        }

        button:hover {
            background: #0055cc;
        }

        .visualizacao-dados {
            margin-top: 20px;
            width: 100%;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #003399;
            color: white;
        }

        #formPartesReprodutivas, #formOrganismos {
            display: none;
        }
    </style>
</head>
<body>
    <header>
        <h1>Algodão-Geag</h1>
    </header>
    <div class="main-content">
        <div class="app-container">
            <h2>Selecione o tipo de avaliação:</h2>
            <div class="form-group">
                <button id="btnPartesReprodutivas">Partes Reprodutivas</button>
                <button id="btnOrganismos">Entomofauna</button>
            </div>
        </div>

        <!-- Formulário para Partes Reprodutivas -->
        <div id="formPartesReprodutivas" class="app-container" style="display: none;">
            <h3>Partes Reprodutivas</h3>
            <form id="formReprodutivas">
                <div class="form-group">
                    <label for="partes">Avaliação:</label>
                    <select id="partes">
                        <option value="solo">Solo</option>
                        <option value="aerea">Aérea</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="pragueiro">Pragueiro:</label>
                    <input type="text" id="pragueiro" placeholder="Digite o nome do pragueiro" required>
                </div>
                <div class="form-group">
                    <label for="data">Data:</label>
                    <input type="date" id="data" required>
                </div>
                <div class="form-group">
                    <label for="estagio">Estágio:</label>
                    <input type="text" id="estagio" placeholder="Digite o estágio" required>
                </div>
                <div class="form-group">
                    <label for="planta">Número de Planta:</label>
                    <input type="number" id="planta" placeholder="Digite o número da planta" required>
                </div>
                <div class="form-group">
                    <label for="botoes">Número de Botões:</label>
                    <input type="number" id="botoes" placeholder="Digite o número de botões" required>
                </div>
                <div class="form-group">
                    <label for="maca">Número de Maçãs:</label>
                    <input type="number" id="maca" placeholder="Digite o número de maçãs" required>
                </div>
                <div class="form-group">
                    <label for="capulhos">Número de Capulhos:</label>
                    <input type="number" id="capulhos" placeholder="Digite o número de capulhos" required>
                </div>
                <div class="form-group">
                    <label for="danosamostra">Danos:</label>
                    <select id="danosamostra">
                        <option value="NDA">NDA-Nenhum Dano</option>
                        <optgroup label="Botões">
                            <option value="BDBO">BDBO-Botão Bicudo Oviposição</option>
                            <option value="BDBA">BDBA-Botão Bicudo Alimentação</option>
                            <option value="BAN">BAN-Botão Abscisão Natural</option>
                            <option value="BOPD">BOPD-Botão Ovipositado Predado</option>
                            <option value="BDL">BDL-Botão Danificado Lagarta</option>
                            <option value="BD">BD-Botão Danificado</option>
                            <option value="FDVA">FDVA-Flor Danificada por Vaquinha</option>
                        </optgroup>
                        <optgroup label="Maçã">
                            <option value="MDBO">MDBO-Maçã Bicudo Oviposição</option>
                            <option value="MDBA">MDBA-Maçã Bicudo Alimentação</option>
                            <option value="MAN">MAN-Maçã Abscisão Natural</option>
                            <option value="MOPD">MOPD-Maçã Ovipositado Predado</option>
                            <option value="MDL">MDL-Maçã Danificado Lagarta</option>
                            <option value="MD">MD-Maçã Danificado</option>
                            <option value="MBP">MBP-Maçã Bico de Papagaio</option>
                        </optgroup>
                        <optgroup label="Capulho">
                            <option value="CDBO">CDBO-Capulho Oviposição Bicudo</option>
                            <option value="CDBA">CDBA-Capulho Alimentação Bicudo</option>
                            <option value="CAN">CAN-Capulho Abscisão Natural</option>
                            <option value="CDF">CDF-Capulho Disturbio Funcional</option>
                            <option value="COPD">COPD-Capulho Ovipositado Predado</option>
                            <option value="CDL">CDL-Capulho Danificado Lagarta</option>
                            <option value="CD">CD-Capulho Danificado</option>
                        </optgroup>
                        <optgroup label="Outro">
                            <option value="outro">Outro</option>
                            <option value="carima">Carimã</option>
                            <option value="causa">Causa Desconhecida</option>
                        </optgroup>
                    </select>
                </div>
                <div class="form-group">
                    <label for="quantidadeDano">Quantidade de Danos:</label>
                    <input type="number" id="quantidadeDano" placeholder="Digite a quantidade de danos" required>
                </div>
                <button type="button" id="salvarReprodutivas">Salvar Dados</button>
                <button type="button" id="baixarReprodutivas">Baixar Dados (Excel)</button>
            </form>
            <div class="visualizacao-dados">
                <h4>Dados Salvos</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Avaliação</th>
                            <th>Pragueiro</th>
                            <th>Data</th>
                            <th>Estágio</th>
                            <th>Número da Planta</th>
                            <th>Número de Botões</th>
                            <th>Número de Maçãs</th>
                            <th>Número de Capulhos</th>
                            <th>Danos</th>
                            <th>Quantidade de Danos</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaReprodutivas"></tbody>
                </table>
            </div>
        </div>

        <!-- Formulário para Organismos -->
        <div id="formOrganismos" class="app-container" style="display: none;">
            <h3>Entomofauna</h3>
            <form id="formOrganismosForm">
                <div class="form-group">
                    <label for="pragueiroOrganismos">Pragueiro:</label>
                    <input type="text" id="pragueiroOrganismos" placeholder="Digite o nome do pragueiro" required>
                </div>
                <div class="form-group">
                    <label for="dataOrganismos">Data:</label>
                    <input type="date" id="dataOrganismos" required>
                </div>
                <div class="form-group">
                    <label for="numeroPlanta">Número da Planta:</label>
                    <input type="number" id="numeroPlanta" placeholder="Digite o número da planta" required>
                </div>
                <div class="form-group">
                    <label for="estagioorganismo">Estágio da Planta:</label>
                    <input type="text" id="estagioorganismo" placeholder="Digite o estágio da planta" required>
                </div>
                <div class="form-group">
                    <label for="tipoOrganismo">Tipo de Organismo:</label>
                    <select id="tipoOrganismo">
                        <option value="NOE">NOE-Nenhum Organismo Encontrado</option>
                        <option value="OUTRO">Outro</option>
                        <optgroup label="Sugadores/Desfolhadores">
                            <option value="TRI">TRI-Tripes fitófago</option>
                            <option value="TRIP">TRIP-Tripes predador</option>
                            <option value="PER">PER-Percevejo desconhecido</option>
                            <option value="PERAP">PERAP-Edessa meditabunda</option>
                            <option value="PG">PG-Pulgão</option>
                            <option value="NFMB">NFMB-Ninfa mosca-branca</option>
                            <option value="MBA">AMB-Adulto mosca-branca</option>
                            <option value="LG">LGG-Lagarta desconhecida</option>
                            <option value="ANTC">ANTC-Anticarsia gemmatalis</option>
                            <option value="HEL">HEL-lagarta helicoverpa</option>
                            <option value="FAL">FAL-Falsa medideira</option>
                            <option value="PLU">PLU-Plutella xyllostella</option>
                            <option value="SPO">SPOD-Spodoptera spp.</option>
                            <option value="ABIC">ABIC-Adulto Bicudo Algodoeiro</option>
                            <option value="LBIC">LBIC-Larva Bicudo Algodoeiro</option>
                        </optgroup>
                        <optgroup label="Polinizadores">
                            <option value="ABL">ABL-Abelha</option>
                            <option value="ASIR">ASIR-Adulto Sirfideo</option>
                            <option value="LSIR">LSIR-Larva Sirfideo</option>
                        </optgroup>
                        <optgroup label="Predadores e Parasitóides">
                            <option value="BLL">Larva Bicho-lixeiro</option>
                            <option value="BLA">Adulto Bicho-lixeiro</option>
                            <option value="OBL">Ovo bicho-lixeiro</option>
                            <option value="TES">TES-Tesourinha</option>
                            <option value="PGM">PGM-Pulgão Mumificado</option>
                            <option value="JOA">JOA-Joaninha</option>
                            <option value="CYC">JOC-Joaninha cycloneda</option>
                            <option value="JP">JP-Joaninha Hipodamia</option>
                            <option value="LJ">LJ-Larva Joaninha</option>
                            <option value="LHIP">LHIP-Larva Joaninha Eriopis</option>
                            <option value="LCYC">LCYC-Larva Joaninha cycloneda</option>
                            <option value="LHIP">LHIP-Larva Joaninha Hipodamia</option>
                            <option value="ERIO">ERIO-Joaninha Eriopis</option>
                            <option value="PERO">PERO-Percevejo Orius</option>
                            <option value="PERP">PER-Percevejo predador</option>
                            <option value="ARN">ANT-Anthycidae</option>
                            <option value="ADOL">ADOL-Dolichopodidae</option>
                            <option value="FOR">FOR-Formiga</option>
                            <option value="ARA">ARA-Aranha Predadora</option>
                            <option value="REDU">REDU-Reduviidae</option>
                            <option value="AC">AC-Acaro</option>
                        </optgroup>
                    </select>
                </div>
                <div class="form-group">
                    <label for="quantidade">Quantidade:</label>
                    <input type="number" id="quantidade" placeholder="Digite a quantidade" required>
                </div>
                <div class="form-group">
                    <label for="observacoes">Observações:</label>
                    <textarea id="observacoes" placeholder="Digite observações"></textarea>
                </div>
                <button type="button" id="salvarOrganismos">Salvar Dados</button>
                <button type="button" id="baixarOrganismos">Baixar Dados (Excel)</button>
            </form>
            <div class="visualizacao-dados">
                <h4>Dados Salvos</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Pragueiro</th>
                            <th>Data</th>
                            <th>Número da Planta</th>
                            <th>Estágio</th>
                            <th>Tipo de Organismo</th>
                            <th>Quantidade</th>
                            <th>Observações</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaOrganismos"></tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const btnPartesReprodutivas = document.getElementById('btnPartesReprodutivas');
        const btnOrganismos = document.getElementById('btnOrganismos');
        const formPartesReprodutivas = document.getElementById('formPartesReprodutivas');
        const formOrganismos = document.getElementById('formOrganismos');
        const tabelaReprodutivas = document.getElementById('tabelaReprodutivas');
        const tabelaOrganismos = document.getElementById('tabelaOrganismos');
        const pragueiroInput = document.getElementById('pragueiro');
        const dataInput = document.getElementById('data');
        const partesSelect = document.getElementById('partes'); // Seleção de avaliação (Solo ou Aérea)
        const pragueiroOrganismosInput = document.getElementById('pragueiroOrganismos');
        const dataOrganismosInput = document.getElementById('dataOrganismos');

        let dadosReprodutivas = JSON.parse(localStorage.getItem('dadosReprodutivas')) || [];
        let dadosOrganismos = JSON.parse(localStorage.getItem('dadosOrganismos')) || [];

        // Função para salvar campos fixos no localStorage
        function salvarCamposFixos() {
            localStorage.setItem('pragueiroFixos', pragueiroInput.value);
            localStorage.setItem('dataFixos', dataInput.value);
            localStorage.setItem('partesFixos', partesSelect.value); // Salva a seleção de avaliação
            localStorage.setItem('pragueiroOrganismosFixos', pragueiroOrganismosInput.value);
            localStorage.setItem('dataOrganismosFixos', dataOrganismosInput.value);
        }

        // Função para carregar campos fixos do localStorage
        function carregarCamposFixos() {
            pragueiroInput.value = localStorage.getItem('pragueiroFixos') || '';
            dataInput.value = localStorage.getItem('dataFixos') || '';
            partesSelect.value = localStorage.getItem('partesFixos') || 'solo'; // Carrega a seleção de avaliação
            pragueiroOrganismosInput.value = localStorage.getItem('pragueiroOrganismosFixos') || '';
            dataOrganismosInput.value = localStorage.getItem('dataOrganismosFixos') || '';
        }

        // Função para mostrar o formulário correto
        function mostrarFormulario(tipo) {
            formPartesReprodutivas.style.display = tipo === 'reprodutivas' ? 'block' : 'none';
            formOrganismos.style.display = tipo === 'organismos' ? 'block' : 'none';
        }

        // Função para atualizar a tabela de partes reprodutivas
        function atualizarTabelaReprodutivas() {
            tabelaReprodutivas.innerHTML = dadosReprodutivas.map((dado, index) => `
                <tr>
                    <td>${dado.avaliacao}</td> <!-- Exibe a avaliação (Solo ou Aérea) -->
                    <td>${dado.pragueiro}</td>
                    <td>${dado.data}</td>
                    <td>${dado.estagio}</td>
                    <td>${dado.planta}</td>
                    <td>${dado.botoes}</td>
                    <td>${dado.macas}</td>
                    <td>${dado.capulhos}</td>
                    <td>${dado.danos}</td>
                    <td>${dado.quantidadeDano}</td>
                    <td><button onclick="excluirLinhaReprodutivas(${index})">Excluir</button></td>
                </tr>
            `).join('');
        }

        // Função para atualizar a tabela de organismos
        function atualizarTabelaOrganismos() {
            tabelaOrganismos.innerHTML = dadosOrganismos.map((dado, index) => `
                <tr>
                    <td>${dado.pragueiro}</td>
                    <td>${dado.data}</td>
                    <td>${dado.numeroPlanta}</td>
                    <td>${dado.estagioorganismo}</td>
                    <td>${dado.tipoOrganismo}</td>
                    <td>${dado.quantidade}</td>
                    <td>${dado.observacoes}</td>
                    <td><button onclick="excluirLinhaOrganismos(${index})">Excluir</button></td>
                </tr>
            `).join('');
        }

        // Função para excluir uma linha da tabela de partes reprodutivas
        function excluirLinhaReprodutivas(index) {
            dadosReprodutivas.splice(index, 1);
            localStorage.setItem('dadosReprodutivas', JSON.stringify(dadosReprodutivas));
            atualizarTabelaReprodutivas();
        }

        // Função para excluir uma linha da tabela de organismos
        function excluirLinhaOrganismos(index) {
            dadosOrganismos.splice(index, 1);
            localStorage.setItem('dadosOrganismos', JSON.stringify(dadosOrganismos));
            atualizarTabelaOrganismos();
        }

        // Função para baixar dados em formato CSV
        function baixarDados(dados, nomeArquivo) {
            const csvContent = [
                Object.keys(dados[0]).join(','), // Cabeçalhos
                ...dados.map(obj => Object.values(obj).join(',')) // Linhas
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `${nomeArquivo}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Event listeners para os botões de seleção de formulário
        btnPartesReprodutivas.addEventListener('click', () => mostrarFormulario('reprodutivas'));
        btnOrganismos.addEventListener('click', () => mostrarFormulario('organismos'));

        // Event listener para salvar dados de partes reprodutivas
        document.getElementById('salvarReprodutivas').addEventListener('click', () => {
            const avaliacao = partesSelect.value; // Captura a seleção de avaliação (Solo ou Aérea)
            const pragueiro = pragueiroInput.value;
            const data = dataInput.value;
            const estagio = document.getElementById('estagio').value;
            const planta = document.getElementById('planta').value;
            const botoes = document.getElementById('botoes').value;
            const macas = document.getElementById('maca').value;
            const capulhos = document.getElementById('capulhos').value;
            const danos = document.getElementById('danosamostra').value;
            const quantidadeDano = document.getElementById('quantidadeDano').value;

            if (pragueiro && data && planta && botoes && macas && capulhos) {
                dadosReprodutivas.push({ avaliacao, pragueiro, data, estagio, planta, botoes, macas, capulhos, danos, quantidadeDano });
                localStorage.setItem('dadosReprodutivas', JSON.stringify(dadosReprodutivas));
                salvarCamposFixos();
                atualizarTabelaReprodutivas();
            }
        });

        // Event listener para salvar dados de organismos
        document.getElementById('salvarOrganismos').addEventListener('click', () => {
            const pragueiro = pragueiroOrganismosInput.value;
            const data = dataOrganismosInput.value;
            const numeroPlanta = document.getElementById('numeroPlanta').value;
            const estagioorganismo = document.getElementById('estagioorganismo').value;
            const tipoOrganismo = document.getElementById('tipoOrganismo').value;
            const quantidade = document.getElementById('quantidade').value;
            const observacoes = document.getElementById('observacoes').value;

            if (pragueiro && data && numeroPlanta && estagioorganismo && tipoOrganismo && quantidade) {
                dadosOrganismos.push({ pragueiro, data, numeroPlanta, estagioorganismo, tipoOrganismo, quantidade, observacoes });
                localStorage.setItem('dadosOrganismos', JSON.stringify(dadosOrganismos));
                atualizarTabelaOrganismos();
                salvarCamposFixos();
            }
        });

        // Event listener para baixar dados de partes reprodutivas
        document.getElementById('baixarReprodutivas').addEventListener('click', () => {
            if (dadosReprodutivas.length > 0) {
                baixarDados(dadosReprodutivas, 'dados_reprodutivas');
            }
        });

        // Event listener para baixar dados de organismos
        document.getElementById('baixarOrganismos').addEventListener('click', () => {
            if (dadosOrganismos.length > 0) {
                baixarDados(dadosOrganismos, 'dados_organismos');
            }
        });

        // Carregar campos fixos ao iniciar
        carregarCamposFixos();
        atualizarTabelaReprodutivas();
        atualizarTabelaOrganismos();

        // Torna as funções de exclusão acessíveis globalmente
        window.excluirLinhaReprodutivas = excluirLinhaReprodutivas;
        window.excluirLinhaOrganismos = excluirLinhaOrganismos;

        // Registrar Service Worker para funcionamento offline
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('Service Worker registrado com sucesso:', registration);
                    })
                    .catch((error) => {
                        console.log('Erro ao registrar o Service Worker:', error);
                    });
            });
        }
    });
</script>
</body>
</html>
